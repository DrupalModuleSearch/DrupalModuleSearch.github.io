webpackJsonp([1],{"+jSJ":function(e,t){},"88RB":function(e,t){},"9Xum":function(e,t){},Llex:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("/5sW"),i=a("bqTm"),r=a.n(i),n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var c=a("VU/8")({name:"App"},n,!1,function(e){a("9Xum")},null,null).exports,o=a("fZjL"),l=a.n(o),u=a("/ocq"),d=a("Gu7T"),g=a.n(d),p=a("O4Lo"),h=a.n(p),f=a("Ci8L"),v=new(a.n(f).a.Client)({host:"https://elastic.thingy-ma-jig.co.uk/"}),_={project_type:{fieldName:"project_type.keyword",title:"Project Type"},compatibility:{fieldName:"compatibility.keyword",title:"Compatibility"},category:{fieldName:"category.keyword",title:"Categories"},maintenance_status:{fieldName:"maintenance_status.keyword",title:"Maintenance Status"},development_status:{fieldName:"development_status.keyword",title:"Development Status"},author:{fieldName:"author.keyword",title:"Authors"}},m={},b=18;var y={search:function(e){var t="*";return void 0!==this.query&&this.query.length>0&&"-"!==this.query&&(t=this.query),v.search({index:"drupal",body:{from:e*b,size:b,query:{bool:{must:{simple_query_string:{query:t,fields:["title^5","project_machine_name^4","body"]}},filter:l()(m).map(function(e){var t=m[e];if(null!==t&&void 0!==t&&t.length>0){var a={terms:{}};return a.terms[_[e].fieldName]=t,a}return null}).filter(function(e){return!!e})}},highlight:{fields:{body:{}}},aggregations:l()(_).reduce(function(e,t){return e[t]={terms:{field:_[t].fieldName}},e},{})}}).then(function(e){return{hits:e.hits,aggregations:l()(e.aggregations).map(function(t){return{key:t,name:_[t].title,items:e.aggregations[t].buckets.map(function(e){var a=e;return a.refined=!1,m[t]&&(a.refined=-1!==m[t].indexOf(e.key)),a}),isRefined:!!m[t]&&m[t].length}})}})},facetMap:_,activeFacets:m,query:"",pageLength:b},C=a("UePd"),k=a("nIHM"),F={props:{aggregation:{type:Object}},components:{"b-collapse":C.a},directives:{"b-toggle":k.a},methods:{refine:function(e){this.$emit("toggleFacet",e.currentTarget.dataset.facetKey,e.currentTarget.dataset.facetValue)}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card card-default facet"},[a("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"collapse_"+e.aggregation.key,expression:"'collapse_' + aggregation.key"}],staticClass:"card-header"},[a("span",{staticClass:"icon"}),e._v(" "),a("span",{staticClass:"card-title small"},[e._v(e._s(e.aggregation.name))])]),e._v(" "),a("b-collapse",{attrs:{id:"collapse_"+e.aggregation.key,visible:!!e.aggregation.isRefined}},[a("ul",{staticClass:"list-group list-group-flush pre-scrollable"},e._l(e.aggregation.items,function(t){return a("li",{key:t.key,staticClass:"list-group-item d-flex justify-content-between align-items-center",class:{refined:t.refined},attrs:{"data-facet-key":e.aggregation.key,"data-facet-value":t.key},on:{click:e.refine}},[a("div",{staticClass:"value small"},[e._v(e._s(t.key))]),e._v(" "),a("span",{staticClass:"badge badge-secondary badge-pill"},[e._v(e._s(t.doc_count))])])}))])],1)},staticRenderFns:[]};var q=a("VU/8")(F,w,!1,function(e){a("PI2V")},null,null).exports,M={props:{aggregations:{type:Array}},components:{Facet:q},data:function(){return{mutableQuery:y.query}},methods:{toggleSidebar:function(){this.$emit("toggleSidebar")},toggleFacet:function(e,t){this.$emit("toggleFacet",e,t)}},computed:{runSearch:function(){return h()(function(e){this.$emit("runSearch",e.srcElement.value)},250).bind(this)}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"sidebar-wrapper"}},[a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-2"},[a("a",{attrs:{id:"menu-toggle"},on:{click:e.toggleSidebar}},[a("i",{staticClass:"fa fa-bars",attrs:{"aria-hidden":"true"}})])]),e._v(" "),a("div",{staticClass:"col-sm-10"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"input-group"},[e._m(0),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.mutableQuery,expression:"mutableQuery"}],staticClass:"form-control",attrs:{type:"search",placeholder:"Search"},domProps:{value:e.mutableQuery},on:{input:[function(t){t.target.composing||(e.mutableQuery=t.target.value)},e.runSearch]}})])]),e._v(" "),a("div",{attrs:{id:"searchSummary"}}),e._v(" "),a("div",{attrs:{id:"searchFacets"}},e._l(e.aggregations,function(t){return a("Facet",{key:t.id,attrs:{aggregation:t},on:{toggleFacet:e.toggleFacet}})}))])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"input-group-prepend"},[t("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[t("i",{staticClass:"fa fa-search",attrs:{"aria-hidden":"true"}})])])}]};var S=a("VU/8")(M,x,!1,function(e){a("mAI+")},null,null).exports,E={props:["hit"],filters:{formatLongNumber:function(e){var t=Math.floor(Math.log(Math.abs(e))/Math.log(1e3)),a="kmbt"[t-1];return a?(e/Math.pow(1e3,t)).toFixed(1)+a:e}}},P={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resultWrapper"},[a("div",{staticClass:"result"},[a("h3",[a("a",{attrs:{href:e.hit._source.url}},[e._v(e._s(e.hit._source.title))])]),e._v(" "),a("p",{staticClass:"badge-group"},[e.hit._source.author?a("span",{staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-user"}),e._v(" "+e._s(e.hit._source.author)+"\n      ")]):e._e(),e._v(" "),e.hit._source.download_count?a("span",{staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-download"}),e._v(" "+e._s(e._f("formatLongNumber")(e.hit._source.download_count))+"\n      ")]):e._e(),e._v(" "),e.hit._source.maintenance_status?a("span",{staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-cog"}),e._v(" "+e._s(e.hit._source.maintenance_status)+"\n      ")]):e._e(),e._v(" "),e.hit._source.development_status?a("span",{staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-code"}),e._v(" "+e._s(e.hit._source.development_status)+"\n      ")]):e._e(),e._v(" "),e._l(e.hit._source.category,function(t){return a("span",{key:t,staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-tag"}),e._v(" "+e._s(t)+"\n      ")])}),e._v(" "),e._l(e.hit._source.compatibility,function(t){return a("span",{key:t,staticClass:"badge badge-pill badge-primary"},[a("i",{staticClass:"fa fa-code-fork"}),e._v(" "+e._s(t)+"\n      ")])}),e._v(" "),e.hit._source.project_type?a("span",{staticClass:"badge badge-pill badge-primary"},[a("i",{staticClass:"fa fa-code-fork"}),e._v(" "+e._s(e.hit._source.project_type)+"\n      ")]):e._e()],2),e._v(" "),e.hit.highlight?a("p",{staticClass:"small body",domProps:{innerHTML:e._s(e.hit.highlight.body[0])}}):e._e()])])},staticRenderFns:[]};var R={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sk-cube-grid"},[a("div",{staticClass:"sk-cube sk-cube1"}),e._v(" "),a("div",{staticClass:"sk-cube sk-cube2"}),e._v(" "),a("div",{staticClass:"sk-cube sk-cube3"}),e._v(" "),a("div",{staticClass:"sk-cube sk-cube4"}),e._v(" "),a("div",{staticClass:"sk-cube sk-cube5"}),e._v(" "),a("div",{staticClass:"sk-cube sk-cube6"}),e._v(" "),a("div",{staticClass:"sk-cube sk-cube7"}),e._v(" "),a("div",{staticClass:"sk-cube sk-cube8"}),e._v(" "),a("div",{staticClass:"sk-cube sk-cube9"})])}]};var $={props:["hits","searchInProgress"],components:{Result:a("VU/8")(E,P,!1,function(e){a("Llex")},null,null).exports,Spinner:a("VU/8")({},R,!1,function(e){a("88RB")},null,null).exports}},j={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"page-content-wrapper"}},[a("div",{staticClass:"container-fluid"},[e._m(0),e._v(" "),a("div",{staticClass:"row"},[null==e.hits?a("p",[e._v("Lets do a search!")]):e._e(),e._v(" "),e._l(e.hits,function(e){return a("Result",{key:e._id,attrs:{hit:e}})}),e._v(" "),e.searchInProgress?a("Spinner"):e._e(),e._v(" "),a("div",{attrs:{id:"pager"}})],2)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"row"},[t("div",{staticClass:"col"},[t("h3",{staticClass:"text-muted"},[this._v("Drupal module search")])])])}]};var I={components:{Sidebar:S,MainPageWrapper:a("VU/8")($,j,!1,function(e){a("+jSJ")},null,null).exports},data:function(){return{sidebarExpanded:!1,hits:null,aggregations:null,page:0,loadMoreEnabled:!1,searchInProgress:!1}},methods:{loadMore:function(){var e=this;this.loadMoreEnabled&&!this.searchInProgress&&(this.page+=1,this.searchInProgress=!0,y.search(this.page).then(function(t){var a;(a=e.hits).push.apply(a,g()(t.hits.hits)),e.aggregations=t.aggregations,e.loadMoreEnabled=y.pageLength===t.hits.hits.length}).finally(function(){e.searchInProgress=!1}))},toggleSidebar:function(){this.sidebarExpanded=!this.sidebarExpanded},updateQuery:function(e){y.query=e,this.updateRoute()},updateRoute:function(){var e={query:y.query};void 0!==e.query&&0!==e.query.length||(e.query="-"),l()(y.facetMap).forEach(function(t){e[t]="-",y.activeFacets[t]&&y.activeFacets[t].length&&(e[t]=y.activeFacets[t].join(","))}),["query"].concat(g()(l()(y.facetMap))).reverse().some(function(t){return"-"!==e[t]||(delete e[t],!1)}),this.$router.push({name:"DrupalModuleSearch",params:e})},toggleFacet:function(e,t){y.activeFacets[e]=y.activeFacets[e]||[];var a=y.activeFacets[e].indexOf(t);-1!==a?y.activeFacets[e].splice(a,1):y.activeFacets[e].push(t),this.updateRoute()}},watch:{"$route.params":{immediate:!0,handler:function(e){var t=this;l()(y.facetMap).forEach(function(t){e[t]&&"-"!==e[t]?y.activeFacets[t]=e[t].split(","):y.activeFacets[t]=null}),void 0===e.query||0===e.query.length||"-"===e.query?y.query=void 0:y.query=e.query,this.page=0,this.searchInProgress=!0,y.search(0).then(function(e){t.hits=e.hits.hits,t.aggregations=e.aggregations,t.loadMoreEnabled=y.pageLength===e.hits.hits.length}).finally(function(){t.searchInProgress=!1})}}}},N={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],class:{sidebarToggled:e.sidebarExpanded},attrs:{id:"wrapper","infinite-scroll-disabled":"busy","infinite-scroll-distance":"10"}},[a("Sidebar",{attrs:{aggregations:e.aggregations},on:{toggleSidebar:e.toggleSidebar,runSearch:e.updateQuery,toggleFacet:e.toggleFacet}}),e._v(" "),a("MainPageWrapper",{attrs:{hits:e.hits,searchInProgress:e.searchInProgress}})],1)},staticRenderFns:[]},L=a("VU/8")(I,N,!1,null,null,null).exports;s.a.use(u.a);var V=["query"].concat(l()(y.facetMap)).map(function(e){return":"+e+"?"}).join("/"),T=new u.a({routes:[{path:"/"+V,name:"DrupalModuleSearch",component:L,props:!0}]});s.a.use(r.a),s.a.config.productionTip=!1,new s.a({el:"#app",router:T,render:function(e){return e(c)}})},PI2V:function(e,t){},"mAI+":function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2423113941c3b4e87970.js.map