(function(e){function t(t){for(var s,n,c=t[0],o=t[1],l=t[2],d=0,p=[];d<c.length;d++)n=c[d],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&p.push(r[n][0]),r[n]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],s=!0,c=1;c<a.length;c++){var o=a[c];0!==r[o]&&(s=!1)}s&&(i.splice(t--,1),e=n(n.s=a[0]))}return e}var s={},r={app:0},i=[];function n(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=s,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(a,s,function(t){return e[t]}.bind(null,s));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=o;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var s=a("2b0e"),r=a("487a"),i=a.n(r),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},c=[],o=(a("5c0b"),a("2877")),l={},u=Object(o["a"])(l,n,c,!1,null,null,null),d=u.exports,p=(a("ac6a"),a("456d"),a("8c4f")),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],class:{sidebarToggled:e.sidebarExpanded},attrs:{id:"wrapper","infinite-scroll-disabled":"busy","infinite-scroll-distance":"10"}},[a("Sidebar",{attrs:{aggregations:e.aggregations},on:{toggleSidebar:e.toggleSidebar,runSearch:e.updateQuery,toggleFacet:e.toggleFacet}}),a("MainPageWrapper",{attrs:{hits:e.hits,searchInProgress:e.searchInProgress}})],1)},f=[],h=(a("28a5"),a("75fc")),b=(a("386d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"sidebar-wrapper"}},[a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-2"},[a("a",{attrs:{id:"menu-toggle"},on:{click:e.toggleSidebar}},[a("i",{staticClass:"fa fa-bars",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"col-sm-10"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"input-group"},[e._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:e.mutableQuery,expression:"mutableQuery"}],staticClass:"form-control",attrs:{type:"search",placeholder:"Search"},domProps:{value:e.mutableQuery},on:{input:[function(t){t.target.composing||(e.mutableQuery=t.target.value)},e.runSearch]}})])]),a("div",{attrs:{id:"searchSummary"}}),a("div",{attrs:{id:"searchFacets"}},e._l(e.aggregations,(function(t){return a("Facet",{key:t.id,attrs:{aggregation:t},on:{toggleFacet:e.toggleFacet}})})),1)])])])])}),m=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"input-group-prepend"},[a("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[a("i",{staticClass:"fa fa-search",attrs:{"aria-hidden":"true"}})])])}],v=a("b047"),_=a.n(v),y=a("293d"),C=a.n(y),k=new C.a.Client({host:"https://elastic.thingy-ma-jig.co.uk/"}),j={type:{fieldName:"type",title:"Type",labels:{project_module:"Module",project_theme:"Theme"}},project_type:{fieldName:"project_type",title:"Project Type"},compatibility:{fieldName:"compatibility",title:"Compatibility"},category:{fieldName:"category",title:"Categories"},maintenance_status:{fieldName:"maintenance_status",title:"Maintenance Status"},development_status:{fieldName:"development_status",title:"Development Status"},author:{fieldName:"author",title:"Authors"}},F={},M="",O=18;function w(e){var t="*";return void 0!==this.query&&this.query.length>0&&"-"!==this.query&&(t=this.query),k.search({index:"prod_drupal",body:{from:e*O,size:O,query:{bool:{must:{simple_query_string:{query:t,fields:["title^10","project_machine_name^4","body"]}},filter:Object.keys(F).map((function(e){var t=F[e];if(null!==t&&void 0!==t&&t.length>0){var a={terms:{}};return a.terms[j[e].fieldName]=t,a}return null})).filter((function(e){return!!e}))}},highlight:{fields:{body:{}}},aggregations:Object.keys(j).reduce((function(e,t){return e[t]={terms:{field:j[t].fieldName}},e}),{})}}).then((function(e){return{hits:e.hits,aggregations:Object.keys(e.aggregations).map((function(t){return{key:t,name:j[t].title,items:e.aggregations[t].buckets.map((function(e){var a=e;return a.refined=!1,F[t]&&(a.refined=-1!==F[t].indexOf(e.key)),a})),isRefined:!!F[t]&&F[t].length}}))}}))}var x={search:w,facetMap:j,activeFacets:F,query:M,pageLength:O},S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card card-default facet"},[a("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"collapse_"+e.aggregation.key,expression:"'collapse_' + aggregation.key"}],staticClass:"card-header"},[a("span",{staticClass:"icon"}),a("span",{staticClass:"card-title small"},[e._v(e._s(e.aggregation.name))])]),a("b-collapse",{attrs:{id:"collapse_"+e.aggregation.key,visible:!!e.aggregation.isRefined}},[a("ul",{staticClass:"list-group list-group-flush pre-scrollable"},e._l(e.aggregation.items,(function(t){return a("li",{key:t.key,staticClass:"list-group-item d-flex justify-content-between align-items-center",class:{refined:t.refined},attrs:{"data-facet-key":e.aggregation.key,"data-facet-value":t.key},on:{click:e.refine}},[a("div",{staticClass:"value small"},[e._v(e._s(e._f("formatFacetKey")(t.key,e.aggregation.key)))]),a("span",{staticClass:"badge badge-secondary badge-pill"},[e._v(e._s(t.doc_count))])])})),0)])],1)},q=[],E=a("5843"),P=a("39ba");s["a"].component("b-collapse",E["a"]),s["a"].directive("b-toggle",P["a"]);var $={props:{aggregation:{type:Object}},methods:{refine:function(e){this.$emit("toggleFacet",e.currentTarget.dataset.facetKey,e.currentTarget.dataset.facetValue)}}},N=$,T=Object(o["a"])(N,S,q,!1,null,null,null),I=T.exports,K={props:{aggregations:{type:Array}},components:{Facet:I},data:function(){return{mutableQuery:x.query}},methods:{toggleSidebar:function(){this.$emit("toggleSidebar")},toggleFacet:function(e,t){this.$emit("toggleFacet",e,t)}},computed:{runSearch:function(){return _()((function(e){this.$emit("runSearch",e.srcElement.value)}),250).bind(this)}}},L=K,Q=Object(o["a"])(L,b,m,!1,null,null,null),R=Q.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"page-content-wrapper"}},[a("div",{staticClass:"container-fluid"},[e._m(0),a("div",{staticClass:"row"},[null==e.hits?a("p",[e._v("Lets do a search!")]):e._e(),e._l(e.hits,(function(e){return a("Result",{key:e._id,attrs:{hit:e}})})),e.searchInProgress?a("Spinner"):e._e(),a("div",{attrs:{id:"pager"}})],2)])])},W=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("h3",{staticClass:"text-muted"},[e._v("Drupal module search")])])])}],A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resultWrapper"},[a("div",{staticClass:"result"},[a("h3",[a("a",{attrs:{href:e.hit._source.url}},[e._v(e._s(e.hit._source.title))])]),a("p",{staticClass:"badge-group"},[e.hit._source.type?a("span",{staticClass:"badge badge-pill badge-info"},[a("i",{staticClass:"fa fa-file-code-o"}),e._v(" "+e._s(e._f("formatFacetKey")(e.hit._source.type,"type"))+"\n      ")]):e._e(),e._l(e.hit._source.compatibility,(function(t){return a("span",{key:t,staticClass:"badge badge-pill badge-primary"},[a("i",{staticClass:"fa fa-code-fork"}),e._v(" "+e._s(e._f("formatFacetKey")(t,"compatibility"))+"\n      ")])})),e.hit._source.project_type?a("span",{staticClass:"badge badge-pill badge-primary"},[a("i",{staticClass:"fa fa-code-fork"}),e._v(" "+e._s(e._f("formatFacetKey")(e.hit._source.project_type,"project_type"))+"\n      ")]):e._e(),e.hit._source.download_count?a("span",{staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-download"}),e._v(" "+e._s(e._f("formatLongNumber")(e.hit._source.download_count))+"\n      ")]):e._e(),e.hit._source.author?a("span",{staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-user"}),e._v(" "+e._s(e.hit._source.author)+"\n      ")]):e._e(),e.hit._source.maintenance_status?a("span",{staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-cog"}),e._v(" "+e._s(e._f("formatFacetKey")(e.hit._source.maintenance_status,"maintenance_status"))+"\n      ")]):e._e(),e.hit._source.development_status?a("span",{staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-code"}),e._v(" "+e._s(e._f("formatFacetKey")(e.hit._source.development_status,"development_status"))+"\n      ")]):e._e(),e._l(e.hit._source.category,(function(t){return a("span",{key:t,staticClass:"badge badge-pill badge-secondary"},[a("i",{staticClass:"fa fa-tag"}),e._v(" "+e._s(e._f("formatFacetKey")(t,"category"))+"\n      ")])}))],2),e.hit.highlight?a("p",{staticClass:"small body"},[e._v(e._s(e._f("striphtml")(e.hit.highlight.body[0])))]):e._e()])])},J=[],z={props:["hit"],filters:{formatLongNumber:function(e){var t=1,a=Math.floor(Math.log(Math.abs(e))/Math.log(1e3)),s="kmbt"[a-1];return s?(e/Math.pow(1e3,a)).toFixed(t)+s:e}}},H=z,V=Object(o["a"])(H,A,J,!1,null,null,null),B=V.exports,G=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},U=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sk-cube-grid"},[a("div",{staticClass:"sk-cube sk-cube1"}),a("div",{staticClass:"sk-cube sk-cube2"}),a("div",{staticClass:"sk-cube sk-cube3"}),a("div",{staticClass:"sk-cube sk-cube4"}),a("div",{staticClass:"sk-cube sk-cube5"}),a("div",{staticClass:"sk-cube sk-cube6"}),a("div",{staticClass:"sk-cube sk-cube7"}),a("div",{staticClass:"sk-cube sk-cube8"}),a("div",{staticClass:"sk-cube sk-cube9"})])}],X={},Y=X,Z=Object(o["a"])(Y,G,U,!1,null,null,null),ee=Z.exports,te={props:["hits","searchInProgress"],components:{Result:B,Spinner:ee}},ae=te,se=Object(o["a"])(ae,D,W,!1,null,null,null),re=se.exports,ie={components:{Sidebar:R,MainPageWrapper:re},data:function(){return{sidebarExpanded:!1,hits:null,aggregations:null,page:0,loadMoreEnabled:!1,searchInProgress:!1}},methods:{loadMore:function(){var e=this;this.loadMoreEnabled&&!this.searchInProgress&&(this.page+=1,this.searchInProgress=!0,x.search(this.page).then((function(t){var a;(a=e.hits).push.apply(a,Object(h["a"])(t.hits.hits)),e.aggregations=t.aggregations,e.loadMoreEnabled=x.pageLength===t.hits.hits.length})).finally((function(){e.searchInProgress=!1})))},toggleSidebar:function(){this.sidebarExpanded=!this.sidebarExpanded},updateQuery:function(e){x.query=e,this.updateRoute()},updateRoute:function(){var e={query:x.query};void 0!==e.query&&0!==e.query.length||(e.query="-"),Object.keys(x.facetMap).forEach((function(t){e[t]="-",x.activeFacets[t]&&x.activeFacets[t].length&&(e[t]=x.activeFacets[t].join(","))})),["query"].concat(Object(h["a"])(Object.keys(x.facetMap))).reverse().some((function(t){return"-"!==e[t]||(delete e[t],!1)})),this.$router.push({name:"DrupalModuleSearch",params:e})},toggleFacet:function(e,t){x.activeFacets[e]=x.activeFacets[e]||[];var a=x.activeFacets[e].indexOf(t);-1!==a?x.activeFacets[e].splice(a,1):x.activeFacets[e].push(t),this.updateRoute()}},watch:{"$route.params":{immediate:!0,handler:function(e){var t=this;Object.keys(x.facetMap).forEach((function(t){e[t]&&"-"!==e[t]?x.activeFacets[t]=e[t].split(","):x.activeFacets[t]=null})),void 0===e.query||0===e.query.length||"-"===e.query?x.query=void 0:x.query=e.query,this.page=0,this.searchInProgress=!0,x.search(0).then((function(e){t.hits=e.hits.hits,t.aggregations=e.aggregations,t.loadMoreEnabled=x.pageLength===e.hits.hits.length})).finally((function(){t.searchInProgress=!1}))}}}},ne=ie,ce=Object(o["a"])(ne,g,f,!1,null,null,null),oe=ce.exports;s["a"].use(p["a"]);var le=["query"].concat(Object.keys(x.facetMap)).map((function(e){return":".concat(e,"?")})).join("/"),ue=new p["a"]({routes:[{path:"/".concat(le),name:"DrupalModuleSearch",component:oe,props:!0}]});s["a"].use(i.a),s["a"].config.productionTip=!1,s["a"].filter("striphtml",(function(e){var t=document.createElement("div");t.innerHTML=e;var a=t.textContent||t.innerText||"";return a})),s["a"].filter("formatFacetKey",(function(e,t){return x.facetMap[t].labels&&x.facetMap[t].labels[e]?x.facetMap[t].labels[e]:e})),new s["a"]({el:"#app",router:ue,render:function(e){return e(d)}})},"5c0b":function(e,t,a){"use strict";var s=a("e332"),r=a.n(s);r.a},e332:function(e,t,a){}});
//# sourceMappingURL=app.b4cd69df.js.map