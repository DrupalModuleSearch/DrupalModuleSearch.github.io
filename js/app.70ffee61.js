(function(){"use strict";var e={774:function(e,t,a){var r=a(963),s=a(252),i=a(296),n=a.n(i);const o={id:"app"};function c(e,t){const a=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",o,[(0,s.Wm)(a)])}var l=a(744);const u={},d=(0,l.Z)(u,[["render",c]]);var g=d,p=a(119),h=a(577);function f(e,t,a,r,i,n){const o=(0,s.up)("DmsSidebar"),c=(0,s.up)("MainPageWrapper");return(0,s.wg)(),(0,s.iD)("div",{id:"wrapper",class:(0,h.C_)({sidebarToggled:i.sidebarExpanded})},[(0,s.Wm)(o,{onToggleSidebar:n.toggleSidebar,onRunSearch:n.updateQuery,onToggleFacet:n.toggleFacet,aggregations:i.aggregations},null,8,["onToggleSidebar","onRunSearch","onToggleFacet","aggregations"]),(0,s.Wm)(c,{hits:i.hits,"search-in-progress":i.searchInProgress,"load-more":n.loadMore,"reset-toggle":i.resetToggle},null,8,["hits","search-in-progress","load-more","reset-toggle"])],2)}const y={id:"sidebar-wrapper"},m={class:"container-fluid"},b={class:"row"},v={class:"col-sm-2"},_=(0,s._)("i",{class:"fa fa-bars","aria-hidden":"true"},null,-1),k=[_],w={class:"col-sm-10"},F={class:"form-group mb-4"},q={class:"input-group"},j=(0,s._)("div",{class:"input-group-text",id:"basic-addon1"},[(0,s._)("i",{class:"fa fa-search","aria-hidden":"true"})],-1),D=(0,s._)("div",{id:"searchSummary"},null,-1),S={id:"searchFacets"};function M(e,t,a,i,n,o){const c=(0,s.up)("Facet");return(0,s.wg)(),(0,s.iD)("div",y,[(0,s._)("div",m,[(0,s._)("div",b,[(0,s._)("div",v,[(0,s._)("a",{id:"menu-toggle",onClick:t[0]||(t[0]=(...e)=>o.toggleSidebar&&o.toggleSidebar(...e))},k)]),(0,s._)("div",w,[(0,s._)("div",F,[(0,s._)("div",q,[j,(0,s.wy)((0,s._)("input",{type:"search",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>n.mutableQuery=e),onInput:t[2]||(t[2]=(...e)=>o.runSearch&&o.runSearch(...e)),placeholder:"Search"},null,544),[[r.nr,n.mutableQuery]])])]),D,(0,s._)("div",S,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.sortedAggregations,(e=>((0,s.wg)(),(0,s.j4)(c,{aggregation:e,key:e.id,onToggleFacet:o.toggleFacet},null,8,["aggregation","onToggleFacet"])))),128))])])])])])}var T=a(279),O=a.n(T),x=a(374),C=a.n(x),I={ELASTIC_INDEX:"prod_drupal"};const K=new(C().Client)({host:"https://elastic.thingy-ma-jig.co.uk/"}),P={type:{fieldName:"type",title:"Type",labels:{project_module:"Module",project_theme:"Theme"}},compatibility:{fieldName:"compatibility",title:"Compatibility"},project_type:{fieldName:"project_type",title:"Project Type"},category:{fieldName:"category",title:"Categories"},maintenance_status:{fieldName:"maintenance_status",title:"Maintenance Status"},development_status:{fieldName:"development_status",title:"Development Status"},author:{fieldName:"author",title:"Authors"}},E={},z="",N=18;function L(e){let t="*";return void 0!==this.query&&this.query.length>0&&"-"!==this.query&&(t=this.query),K.search({index:I.ELASTIC_INDEX,body:{from:e*N,size:N,query:{bool:{must:{simple_query_string:{query:t,fields:["title^10","project_machine_name^4","body"]}},filter:Object.keys(E).map((e=>{const t=E[e];if(null!==t&&void 0!==t&&t.length>0){const a={terms:{}};return a.terms[P[e].fieldName]=t,a}return null})).filter((e=>!!e))}},highlight:{fields:{body:{}}},aggregations:Object.keys(P).reduce(((e,t)=>(e[t]={terms:{field:P[t].fieldName}},e)),{})}}).then((e=>({hits:e.hits,aggregations:Object.keys(e.aggregations).map((t=>({key:t,name:P[t].title,items:e.aggregations[t].buckets.map((e=>{const a=e;return a.refined=!1,E[t]&&(a.refined=-1!==E[t].indexOf(e.key)),a})),isRefined:!!E[t]&&E[t].length})))})))}var R={search:L,facetMap:P,activeFacets:E,query:z,pageLength:N};const U=(0,s._)("span",{class:"icon"},null,-1),$={class:"card-title small"},A=["id"],W=["data-facet-key","data-facet-value"],Z={class:"value"},H={class:"count"};function Q(e,t,a,r,i,n){return(0,s.wg)(),(0,s.iD)("div",{class:(0,h.C_)(["card card-default facet",{collapsed:e.collapsed}])},[(0,s._)("div",{class:"card-header",onClick:t[0]||(t[0]=(...e)=>n.toggleCollapse&&n.toggleCollapse(...e))},[U,(0,s._)("span",$,(0,h.zw)(a.aggregation.name),1)]),(0,s._)("ul",{id:"collapse_"+a.aggregation.key,class:"list-group list-group-flush"},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.aggregation.items,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.key,class:(0,h.C_)(["list-group-item d-flex justify-content-between align-items-center",{refined:e.refined}]),"data-facet-key":a.aggregation.key,"data-facet-value":e.key,onClick:t[1]||(t[1]=(...e)=>n.refine&&n.refine(...e))},[(0,s._)("div",Z,(0,h.zw)(n.formatFacetKey(e.key,a.aggregation.key)),1),(0,s._)("span",H,(0,h.zw)(e.doc_count),1)],10,W)))),128))],8,A)],2)}var Y={props:{aggregation:{type:Object,required:!0}},data:function(){return{collapsed:!this.aggregation.isRefined}},computed:{formatFacetKey(){return(e,t)=>R.facetMap[t].labels&&R.facetMap[t].labels[e]?R.facetMap[t].labels[e]:e}},methods:{refine(e){this.$emit("toggleFacet",e.currentTarget.dataset.facetKey,e.currentTarget.dataset.facetValue)},toggleCollapse(){this.collapsed=!this.collapsed}}};const B=(0,l.Z)(Y,[["render",Q]]);var V=B,X={props:{aggregations:{type:Array,default(){return[]}}},components:{Facet:V},data(){return{mutableQuery:R.query}},methods:{toggleSidebar(){this.$emit("toggleSidebar")},toggleFacet(e,t){this.$emit("toggleFacet",e,t)}},computed:{sortedAggregations(){return this.aggregations?Object.keys(R.facetMap).reduce(((e,t)=>{const a=this.aggregations.find((e=>e.key===t));return a&&e.push(a),e}),[]):[]},runSearch(){return O()((function(e){this.$emit("runSearch",e.srcElement.value)}),250).bind(this)}}};const G=(0,l.Z)(X,[["render",M]]);var J=G;const ee={id:"page-content-wrapper"},te={class:"container-fluid"},ae=(0,s._)("div",{class:"row"},[(0,s._)("div",{class:"col"},[(0,s._)("h3",{class:"text-muted"}," Drupal module search ")])],-1),re={id:"results",class:"row"},se={key:0};function ie(e,t,a,r,i,n){const o=(0,s.up)("DmsResult"),c=(0,s.up)("DmsSpinner"),l=(0,s.up)("InfiniteLoading");return(0,s.wg)(),(0,s.iD)("div",ee,[(0,s._)("div",te,[ae,(0,s._)("div",re,[null==a.hits?((0,s.wg)(),(0,s.iD)("p",se," Lets do a search! ")):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.hits,(e=>((0,s.wg)(),(0,s.j4)(o,{hit:e,key:e._id},null,8,["hit"])))),128)),a.searchInProgress?((0,s.wg)(),(0,s.j4)(c,{key:1})):(0,s.kq)("",!0),(0,s.Wm)(l,{onInfinite:a.loadMore,distance:240,"first-load":!1,identifier:a.resetToggle},null,8,["onInfinite","identifier"])])])])}const ne={class:"resultWrapper"},oe={class:"result p-3 mb-4 bg-white shadow-sm border border-gray"},ce=["href"],le={class:"badge-group mb-2"},ue={key:0,class:"badge rounded-pill bg-info"},de=(0,s._)("i",{class:"fa fa-file-code-o"},null,-1),ge=(0,s._)("i",{class:"fa fa-code-fork"},null,-1),pe={key:1,class:"badge rounded-pill bg-primary"},he=(0,s._)("i",{class:"fa fa-code-fork"},null,-1),fe={key:2,class:"badge rounded-pill bg-secondary"},ye=(0,s._)("i",{class:"fa fa-user"},null,-1),me={key:3,class:"badge rounded-pill bg-secondary"},be=(0,s._)("i",{class:"fa fa-cog"},null,-1),ve={key:4,class:"badge rounded-pill bg-secondary"},_e=(0,s._)("i",{class:"fa fa-code"},null,-1),ke=(0,s._)("i",{class:"fa fa-tag"},null,-1),we={key:0,class:"small body"};function Fe(e,t,a,r,i,n){return(0,s.wg)(),(0,s.iD)("div",ne,[(0,s._)("div",oe,[(0,s._)("h3",null,[(0,s._)("a",{href:a.hit._source.url},(0,h.zw)(a.hit._source.title),9,ce)]),(0,s._)("div",le,[a.hit._source.type?((0,s.wg)(),(0,s.iD)("span",ue,[de,(0,s.Uk)(" "+(0,h.zw)(n.formatFacetKey(a.hit._source.type,"type")),1)])):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.hit._source.compatibility,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e,class:"badge rounded-pill bg-primary"},[ge,(0,s.Uk)(" "+(0,h.zw)(n.formatFacetKey(e,"compatibility")),1)])))),128)),a.hit._source.project_type?((0,s.wg)(),(0,s.iD)("span",pe,[he,(0,s.Uk)(" "+(0,h.zw)(n.formatFacetKey(a.hit._source.project_type,"project_type")),1)])):(0,s.kq)("",!0),a.hit._source.author?((0,s.wg)(),(0,s.iD)("span",fe,[ye,(0,s.Uk)(" "+(0,h.zw)(a.hit._source.author),1)])):(0,s.kq)("",!0),a.hit._source.maintenance_status?((0,s.wg)(),(0,s.iD)("span",me,[be,(0,s.Uk)(" "+(0,h.zw)(n.formatFacetKey(a.hit._source.maintenance_status,"maintenance_status")),1)])):(0,s.kq)("",!0),a.hit._source.development_status?((0,s.wg)(),(0,s.iD)("span",ve,[_e,(0,s.Uk)(" "+(0,h.zw)(n.formatFacetKey(a.hit._source.development_status,"development_status")),1)])):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.hit._source.category,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e,class:"badge rounded-pill bg-secondary"},[ke,(0,s.Uk)(" "+(0,h.zw)(n.formatFacetKey(e,"category")),1)])))),128))]),a.hit.highlight?((0,s.wg)(),(0,s.iD)("p",we,(0,h.zw)(n.cleanBody(a.hit._source.body)),1)):(0,s.kq)("",!0)])])}var qe={props:{hit:{type:Object,required:!0}},computed:{formatFacetKey(){return(e,t)=>R.facetMap[t].labels&&R.facetMap[t].labels[e]?R.facetMap[t].labels[e]:e},formatLongNumber(e){const t=1,a=Math.floor(Math.log(Math.abs(e))/Math.log(1e3)),r="kmbt"[a-1];return r?(e/1e3**a).toFixed(t)+r:e},cleanBody(){return e=>{var t=document.createElement("div");t.innerHTML=e;var a=t.textContent||t.innerText||"";return a}}}};const je=(0,l.Z)(qe,[["render",Fe]]);var De=je;const Se={class:"sk-cube-grid"},Me=(0,s.uE)('<div class="sk-cube sk-cube1"></div><div class="sk-cube sk-cube2"></div><div class="sk-cube sk-cube3"></div><div class="sk-cube sk-cube4"></div><div class="sk-cube sk-cube5"></div><div class="sk-cube sk-cube6"></div><div class="sk-cube sk-cube7"></div><div class="sk-cube sk-cube8"></div><div class="sk-cube sk-cube9"></div>',9),Te=[Me];function Oe(e,t,a,r,i,n){return(0,s.wg)(),(0,s.iD)("div",Se,Te)}var xe={};const Ce=(0,l.Z)(xe,[["render",Oe]]);var Ie=Ce,Ke={props:{hits:{type:Array,default(){return[]}},searchInProgress:{type:Boolean,default:!1},loadMore:{type:Function,required:!0},resetToggle:{type:Boolean,required:!0}},components:{DmsResult:De,DmsSpinner:Ie}};const Pe=(0,l.Z)(Ke,[["render",ie]]);var Ee=Pe,ze={components:{DmsSidebar:J,MainPageWrapper:Ee},data(){return{sidebarExpanded:!1,hits:null,aggregations:null,page:0,resetToggle:!1,searchInProgress:!1}},methods:{loadMore(e){e.loading(),this.page+=1,this.searchInProgress=!0,R.search(this.page).then((t=>{this.hits.push(...t.hits.hits),this.aggregations=t.aggregations,t.hits.hits.length<R.pageLength&&e.complete()})).catch((()=>{e.error()})).finally((()=>{this.searchInProgress=!1,e.loaded()}))},toggleSidebar(){this.sidebarExpanded=!this.sidebarExpanded},updateQuery(e){R.query=e,this.updateRoute()},updateRoute(){const e={query:R.query};void 0!==e.query&&0!==e.query.length||(e.query="-"),Object.keys(R.facetMap).forEach((t=>{e[t]="-",R.activeFacets[t]&&R.activeFacets[t].length&&(e[t]=R.activeFacets[t].join(","))})),["query",...Object.keys(R.facetMap)].reverse().some((t=>"-"!==e[t]||(delete e[t],!1))),this.$router.push({name:"DrupalModuleSearch",params:e})},toggleFacet(e,t){R.activeFacets[e]=R.activeFacets[e]||[];const a=R.activeFacets[e].indexOf(t);-1!==a?R.activeFacets[e].splice(a,1):R.activeFacets[e].push(t),this.updateRoute()}},watch:{"$route.params":{immediate:!0,handler(e){Object.keys(R.facetMap).forEach((t=>{e[t]&&"-"!==e[t]?R.activeFacets[t]=e[t].split(","):R.activeFacets[t]=null})),void 0===e.query||0===e.query.length||"-"===e.query?R.query=void 0:R.query=e.query,this.page=0,this.searchInProgress=!0,this.resetToggle=!this.resetToggle,R.search(0).then((e=>{this.hits=e.hits.hits,this.aggregations=e.aggregations})).finally((()=>{this.searchInProgress=!1}))}}}};const Ne=(0,l.Z)(ze,[["render",f]]);var Le=Ne;const Re=["query"].concat(Object.keys(R.facetMap)).map((e=>`:${e}?`)).join("/");var Ue=new p.p7({history:(0,p.r5)(),routes:[{path:`/${Re}`,name:"DrupalModuleSearch",component:Le,props:!0}]});const $e=(0,r.ri)({render:()=>(0,s.h)(g)});$e.use(Ue),$e.component("InfiniteLoading",n()),$e.mount("#app")}},t={};function a(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,r,s,i){if(!r){var n=1/0;for(u=0;u<e.length;u++){r=e[u][0],s=e[u][1],i=e[u][2];for(var o=!0,c=0;c<r.length;c++)(!1&i||n>=i)&&Object.keys(a.O).every((function(e){return a.O[e](r[c])}))?r.splice(c--,1):(o=!1,i<n&&(n=i));if(o){e.splice(u--,1);var l=s();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[r,s,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,i,n=r[0],o=r[1],c=r[2],l=0;if(n.some((function(t){return 0!==e[t]}))){for(s in o)a.o(o,s)&&(a.m[s]=o[s]);if(c)var u=c(a)}for(t&&t(r);l<n.length;l++)i=n[l],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(u)},r=self["webpackChunkdrupal_module_search"]=self["webpackChunkdrupal_module_search"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=a.O(void 0,[998],(function(){return a(774)}));r=a.O(r)})();
//# sourceMappingURL=app.70ffee61.js.map